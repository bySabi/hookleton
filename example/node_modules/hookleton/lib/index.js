"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react=require("react");function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,r,e){return r&&_defineProperties(t.prototype,r),e&&_defineProperties(t,e),t}function _slicedToArray(t,r){return _arrayWithHoles(t)||_iterableToArrayLimit(t,r)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _iterableToArrayLimit(t,r){var e=[],n=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(n=(i=u.next()).done)&&(e.push(i.value),!r||e.length!==r);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw a}}return e}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function createHook(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return createHookWithClass.apply(void 0,[Hookleton,t].concat(e))}function createHookWithClass(t,r){for(var e=arguments.length,n=new Array(e>2?e-2:0),o=2;o<e;o++)n[o-2]=arguments[o];var a=new t(r,n),i=a.use.bind(a);return i.get=function(){return a._o},i}var Hookleton=function(){function t(r,e){_classCallCheck(this,t),this._hook=r,this._a=e,this._up=new Map,this._h=!1}return _createClass(t,[{key:"use",value:function(){for(var t=this,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var o=react.useRef(!1);return react.useMemo(function(){return t._init({refUse:o,initialArgs:e})},[]),o.current?(this._o=this._hook.apply(this,_toConsumableArray(this._arg)),react.useMemo(function(){if(!Array.isArray(t._o))throw new Error("[Hookleton] provided Hook must return array values")},[]),react.useLayoutEffect(function(){return function(){return t._h=!1}},[]),this.useHost(this._arg)):this.useNonHost(e)}},{key:"useHost",value:function(){var t=this;return react.useEffect(function(){return t._notify2()},[this._o[0]]),this._o}},{key:"useNonHost",value:function(){var t=this,r=_slicedToArray(react.useState(),2)[1];return react.useLayoutEffect(function(){return t._up.set(r,wrapUpdater(r)),function(){return t._up.delete(r)}},[]),this._o}},{key:"_init",value:function(t){var r=t.refUse,e=t.initialArgs;!1===this._h&&(this._h=!0,this._o=[],r.current=!0,this._arg=this._a.length>0?this._a:e,this._notify2=function(){this._notify2=this._notify})}},{key:"_notify",value:function(){var t=this;this._up.forEach(function(r){return r(t._o[0])})}}]),t}(),wrapUpdater=function(t){return function(){return t(forceUpdate)}},forceUpdate=function(t){return~t};exports.createHook=createHook,exports.createHookWithClass=createHookWithClass,exports.Hookleton=Hookleton;
